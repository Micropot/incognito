<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>API - Incognito-anonymizer</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "API";
        var mkdocs_page_input_path = "api.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Incognito-anonymizer
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">API</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#anonymizer">Anonymizer</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#incognito_anonymizer.anonymizer">anonymizer</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#incognito_anonymizer.anonymizer.Anonymizer">Anonymizer</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.anonymizer.Anonymizer.anonymize">anonymize</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.anonymizer.Anonymizer.open_json_file">open_json_file</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.anonymizer.Anonymizer.open_text_file">open_text_file</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.anonymizer.Anonymizer.set_info">set_info</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.anonymizer.Anonymizer.set_masks">set_masks</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.anonymizer.Anonymizer.set_strategies">set_strategies</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#anonlyzer">Anonlyzer</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#incognito_anonymizer.analyzer">analyzer</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#incognito_anonymizer.analyzer.PiiStrategy">PiiStrategy</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.analyzer.PiiStrategy.analyze">analyze</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.analyzer.PiiStrategy.hide_by_keywords">hide_by_keywords</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#incognito_anonymizer.analyzer.RegexStrategy">RegexStrategy</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.analyzer.RegexStrategy.analyze">analyze</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.analyzer.RegexStrategy.multi_subs_by_regex">multi_subs_by_regex</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#incognito_anonymizer.analyzer.Strategy">Strategy</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#mask">Mask</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#incognito_anonymizer.mask">mask</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#incognito_anonymizer.mask.FakeStrategy">FakeStrategy</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.mask.FakeStrategy.mask">mask</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#incognito_anonymizer.mask.HashStrategy">HashStrategy</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#incognito_anonymizer.mask.HideStrategy">HideStrategy</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.mask.HideStrategy.mask">mask</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#incognito_anonymizer.mask.PlaceholderStrategy">PlaceholderStrategy</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#incognito_anonymizer.mask.PlaceholderStrategy.mask">mask</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Incognito-anonymizer</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">API</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="api">API</h1>
<h2 id="anonymizer">Anonymizer</h2>


<div class="doc doc-object doc-module">



<a id="incognito_anonymizer.anonymizer"></a>
    <div class="doc doc-contents first">

        <p>Text anonymization module</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="incognito_anonymizer.anonymizer.Anonymizer" class="doc doc-heading">
            <code>Anonymizer</code>


</h2>


    <div class="doc doc-contents ">


        <p>Anonymization class based on strategies formating</p>






              <details class="quote">
                <summary>Source code in <code>incognito_anonymizer/anonymizer.py</code></summary>
                <pre class="highlight"><code class="language-python">class Anonymizer:
    """Anonymization class based on strategies formating"""

    # available strategies
    STRATEGIES = {
        "regex": analyzer.RegexStrategy(),
        "pii": analyzer.PiiStrategy(),
    }

    # available masks
    MASKS = {
        "placeholder": mask.PlaceholderStrategy(),
        "fake": mask.FakeStrategy(),
        "hash": mask.HashStrategy(),
        "hide": mask.HideStrategy(),
    }

    def __init__(self):

        self.infos = None
        self.position = []

    def open_text_file(self, path: str) -&gt; str:
        """
        Open input txt file

        :param path: path of the input txt file
        :returns: file content
        :raises FileExistsError: if given file not found
        """
        try:
            with open(path, "r") as f:
                content = f.read()
            return content
        except FileNotFoundError as e:
            print(e)
            raise

    def open_json_file(self, path: str) -&gt; str:
        """
        Open input json file for personal infos

        :param path: path of the json file
        :returns: file content
        :raises FileExistsError: if given file not found
        """
        try:
            with open(path, "r") as f:
                data = json.load(f)
            return data
        except FileNotFoundError as e:
            print(e)
            raise

    def set_info(self, infos: dict) -&gt; analyzer.PersonalInfo:
        """
        Set dict to PersonalInfo Class

        :param infos: dict with all the Personal info values
        """
        self.infos = analyzer.PersonalInfo(**infos)
        return self.infos

    def set_strategies(self, strategies: list):
        """
        Set strategies

        :param list: list of wanted strategies
        """
        self.used_strats = strategies

    def set_masks(self, mask: str):
        """
        Set masks

        :param mask: wanted mask
        """
        self.used_mask = mask

    def anonymize(self, text: str) -&gt; str:
        """
        Global function to anonymise a text base on the choosen strategies

        :param text: text to anonymize
        :returns: anonimized text
        """
        if not text:
            text = "NaN"
        spans = {}
        for strategy in self.used_strats:
            current_strategy = Anonymizer.STRATEGIES.get(strategy)

            current_strategy.info = self.infos
            span = current_strategy.analyze(text=text)
            spans.update(span)

            current_mask = Anonymizer.MASKS.get(self.used_mask)
            anonymized_text = current_mask.mask(text, spans)
            text = anonymized_text
            spans = {}
        return anonymized_text</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.anonymizer.Anonymizer.anonymize" class="doc doc-heading">
            <code class="highlight language-python">anonymize(text)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Global function to anonymise a text base on the choosen strategies</p>
<p>:param text: text to anonymize
:returns: anonimized text</p>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/anonymizer.py</code></summary>
              <pre class="highlight"><code class="language-python">def anonymize(self, text: str) -&gt; str:
    """
    Global function to anonymise a text base on the choosen strategies

    :param text: text to anonymize
    :returns: anonimized text
    """
    if not text:
        text = "NaN"
    spans = {}
    for strategy in self.used_strats:
        current_strategy = Anonymizer.STRATEGIES.get(strategy)

        current_strategy.info = self.infos
        span = current_strategy.analyze(text=text)
        spans.update(span)

        current_mask = Anonymizer.MASKS.get(self.used_mask)
        anonymized_text = current_mask.mask(text, spans)
        text = anonymized_text
        spans = {}
    return anonymized_text</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.anonymizer.Anonymizer.open_json_file" class="doc doc-heading">
            <code class="highlight language-python">open_json_file(path)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Open input json file for personal infos</p>
<p>:param path: path of the json file
:returns: file content
:raises FileExistsError: if given file not found</p>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/anonymizer.py</code></summary>
              <pre class="highlight"><code class="language-python">def open_json_file(self, path: str) -&gt; str:
    """
    Open input json file for personal infos

    :param path: path of the json file
    :returns: file content
    :raises FileExistsError: if given file not found
    """
    try:
        with open(path, "r") as f:
            data = json.load(f)
        return data
    except FileNotFoundError as e:
        print(e)
        raise</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.anonymizer.Anonymizer.open_text_file" class="doc doc-heading">
            <code class="highlight language-python">open_text_file(path)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Open input txt file</p>
<p>:param path: path of the input txt file
:returns: file content
:raises FileExistsError: if given file not found</p>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/anonymizer.py</code></summary>
              <pre class="highlight"><code class="language-python">def open_text_file(self, path: str) -&gt; str:
    """
    Open input txt file

    :param path: path of the input txt file
    :returns: file content
    :raises FileExistsError: if given file not found
    """
    try:
        with open(path, "r") as f:
            content = f.read()
        return content
    except FileNotFoundError as e:
        print(e)
        raise</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.anonymizer.Anonymizer.set_info" class="doc doc-heading">
            <code class="highlight language-python">set_info(infos)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Set dict to PersonalInfo Class</p>
<p>:param infos: dict with all the Personal info values</p>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/anonymizer.py</code></summary>
              <pre class="highlight"><code class="language-python">def set_info(self, infos: dict) -&gt; analyzer.PersonalInfo:
    """
    Set dict to PersonalInfo Class

    :param infos: dict with all the Personal info values
    """
    self.infos = analyzer.PersonalInfo(**infos)
    return self.infos</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.anonymizer.Anonymizer.set_masks" class="doc doc-heading">
            <code class="highlight language-python">set_masks(mask)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Set masks</p>
<p>:param mask: wanted mask</p>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/anonymizer.py</code></summary>
              <pre class="highlight"><code class="language-python">def set_masks(self, mask: str):
    """
    Set masks

    :param mask: wanted mask
    """
    self.used_mask = mask</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.anonymizer.Anonymizer.set_strategies" class="doc doc-heading">
            <code class="highlight language-python">set_strategies(strategies)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Set strategies</p>
<p>:param list: list of wanted strategies</p>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/anonymizer.py</code></summary>
              <pre class="highlight"><code class="language-python">def set_strategies(self, strategies: list):
    """
    Set strategies

    :param list: list of wanted strategies
    """
    self.used_strats = strategies</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="anonlyzer">Anonlyzer</h2>


<div class="doc doc-object doc-module">



<a id="incognito_anonymizer.analyzer"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="incognito_anonymizer.analyzer.PiiStrategy" class="doc doc-heading">
            <code>PiiStrategy</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="incognito_anonymizer.analyzer.Strategy" href="#incognito_anonymizer.analyzer.Strategy">Strategy</a></code></p>


        <p>Detect personal infos</p>






              <details class="quote">
                <summary>Source code in <code>incognito_anonymizer/analyzer.py</code></summary>
                <pre class="highlight"><code class="language-python">class PiiStrategy(Strategy):
    """Detect personal infos"""

    def __init__(self):
        self.info: PersonalInfo = None

    def hide_by_keywords(
        self, text: str, keywords: Iterable[Tuple[str, str]]
    ) -&gt; Dict[Tuple[int, int], str]:
        """
        Hide text using keywords and return positions with replacements.

        :param text: text to anonymize
        :param keywords: Iterable of tuples (word, replacement).


        :returns: List of tuples where each tuple contains:
                - A tuple with the start and end positions of the word.
                - The replacement string.
        """
        processor = KeywordProcessor(case_sensitive=False)
        for key, masks in keywords:
            processor.add_keyword(key, masks)

        # Extract keywords with positions
        found_keywords = processor.extract_keywords(text, span_info=True)

        result = {}
        for replacement, start, end in found_keywords:
            # Wrap positions as a tuple of tuples
            key = ((start, end),)
            if key in result:
                result[key] = replacement  # Handle multiple occurrences
            else:
                result[key] = replacement

        return result

    def analyze(self, text: str) -&gt; str:
        """
        Hide specific words based on keywords

        :param text: text to anonymize
        """
        keywords: tuple
        if isinstance(self.info, PersonalInfo):
            keywords = (
                (self.info.first_name, "&lt;NAME&gt;"),
                (self.info.last_name, "&lt;NAME&gt;"),
                (self.info.birth_name, "&lt;NAME&gt;"),
                (self.info.ipp, "&lt;IPP&gt;"),
                (self.info.postal_code, "&lt;CODE_POSTAL&gt;"),
                (self.info.birthdate.strftime("%m/%d/%Y"), "&lt;DATE&gt;"),
                (self.info.birthdate.strftime("%m %d %Y"), "&lt;DATE&gt;"),
                (self.info.birthdate.strftime("%m:%d:%Y"), "&lt;DATE&gt;"),
                (self.info.birthdate.strftime("%m-%d-%Y"), "&lt;DATE&gt;"),
                (self.info.birthdate.strftime("%Y-%m-%d"), "&lt;DATE&gt;"),
                (self.info.adress, "&lt;ADRESSE&gt;"),
            )

        return self.hide_by_keywords(text, [(info, tag) for info, tag in keywords if info])</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.analyzer.PiiStrategy.analyze" class="doc doc-heading">
            <code class="highlight language-python">analyze(text)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Hide specific words based on keywords</p>
<p>:param text: text to anonymize</p>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/analyzer.py</code></summary>
              <pre class="highlight"><code class="language-python">def analyze(self, text: str) -&gt; str:
    """
    Hide specific words based on keywords

    :param text: text to anonymize
    """
    keywords: tuple
    if isinstance(self.info, PersonalInfo):
        keywords = (
            (self.info.first_name, "&lt;NAME&gt;"),
            (self.info.last_name, "&lt;NAME&gt;"),
            (self.info.birth_name, "&lt;NAME&gt;"),
            (self.info.ipp, "&lt;IPP&gt;"),
            (self.info.postal_code, "&lt;CODE_POSTAL&gt;"),
            (self.info.birthdate.strftime("%m/%d/%Y"), "&lt;DATE&gt;"),
            (self.info.birthdate.strftime("%m %d %Y"), "&lt;DATE&gt;"),
            (self.info.birthdate.strftime("%m:%d:%Y"), "&lt;DATE&gt;"),
            (self.info.birthdate.strftime("%m-%d-%Y"), "&lt;DATE&gt;"),
            (self.info.birthdate.strftime("%Y-%m-%d"), "&lt;DATE&gt;"),
            (self.info.adress, "&lt;ADRESSE&gt;"),
        )

    return self.hide_by_keywords(text, [(info, tag) for info, tag in keywords if info])</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.analyzer.PiiStrategy.hide_by_keywords" class="doc doc-heading">
            <code class="highlight language-python">hide_by_keywords(text, keywords)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Hide text using keywords and return positions with replacements.</p>
<p>:param text: text to anonymize
:param keywords: Iterable of tuples (word, replacement).</p>
<p>:returns: List of tuples where each tuple contains:
        - A tuple with the start and end positions of the word.
        - The replacement string.</p>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/analyzer.py</code></summary>
              <pre class="highlight"><code class="language-python">def hide_by_keywords(
    self, text: str, keywords: Iterable[Tuple[str, str]]
) -&gt; Dict[Tuple[int, int], str]:
    """
    Hide text using keywords and return positions with replacements.

    :param text: text to anonymize
    :param keywords: Iterable of tuples (word, replacement).


    :returns: List of tuples where each tuple contains:
            - A tuple with the start and end positions of the word.
            - The replacement string.
    """
    processor = KeywordProcessor(case_sensitive=False)
    for key, masks in keywords:
        processor.add_keyword(key, masks)

    # Extract keywords with positions
    found_keywords = processor.extract_keywords(text, span_info=True)

    result = {}
    for replacement, start, end in found_keywords:
        # Wrap positions as a tuple of tuples
        key = ((start, end),)
        if key in result:
            result[key] = replacement  # Handle multiple occurrences
        else:
            result[key] = replacement

    return result</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="incognito_anonymizer.analyzer.RegexStrategy" class="doc doc-heading">
            <code>RegexStrategy</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="incognito_anonymizer.analyzer.Strategy" href="#incognito_anonymizer.analyzer.Strategy">Strategy</a></code></p>


        <p>Detect word based on regex</p>






              <details class="quote">
                <summary>Source code in <code>incognito_anonymizer/analyzer.py</code></summary>
                <pre class="highlight"><code class="language-python">class RegexStrategy(Strategy):
    """Detect word based on regex"""

    def __init__(self):
        Xxxxx = r"[A-Z]\p{Ll}+"
        XXxX_ = r"[A-Z][A-Z\p{Ll}-]"
        sep = r"(?:[ ]*|-)?"

        self.title_regex = r"([Dd][Rr][.]?|[Dd]octeur|[mM]r?[.]?|[Ii]nterne[ ]*:?|[Ee]xterne[ ]*:?|[Mm]onsieur|[Mm]adame|[Rr].f.rent[ ]*:?|[P]r[.]?|[Pp]rofesseure?|\s[Mm]me[.]?|[Ee]nfant|[Mm]lle|[Nn]ée?)"

        self.email_pattern = r"(?:[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*|\"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])"

        self.PATTERNS = {
            # rf"(?&lt;={self.title_regex})([\s-][A-Z]+)+([\s-][A-Z][a-z]+)+(?![a-z])": "&lt;NAME&gt;",
            rf"(?&lt;={self.title_regex}[ ]+)(?P&lt;LN0&gt;[A-Z][A-Z](?:{sep}(?:ep[.]|de|[A-Z]+))*)[ ]+(?P&lt;FN0&gt;{Xxxxx}(?:{sep}{Xxxxx})*)": "&lt;NAME&gt;",
            rf"(?&lt;={self.title_regex}[ ]+)(?P&lt;FN1&gt;{Xxxxx}(?:{sep}{Xxxxx})*)[ ]+(?P&lt;LN1&gt;[A-Z][A-Z]+(?:{sep}(?:ep[.]|de|[A-Z]+))*)": "&lt;NAME&gt;",
            rf"(?&lt;={self.title_regex}[ ]+)(?P&lt;LN3&gt;{Xxxxx}(?:(?:-|[ ]de[ ]|[ ]ep[.][ ]){Xxxxx})*)[ ]+(?P&lt;FN2&gt;{Xxxxx}(?:-{Xxxxx})*)": "&lt;NAME&gt;",
            rf"(?&lt;={self.title_regex}[ ]+)(?P&lt;LN2&gt;{XXxX_}+(?:{sep}{XXxX_}+)*)": "&lt;NAME&gt;",
            rf"(?&lt;={self.title_regex}[ ]+)(?P&lt;FN0&gt;[A-Z][.])\s+(?P&lt;LN0&gt;{XXxX_}+(?:{sep}{XXxX_}+)*)": "&lt;NAME&gt;",
            r"[12]\s*[0-9]{2}\s*(0[1-9]|1[0-2])\s*(2[AB]|[0-9]{2})\s*[0-9]{3}\s*[0-9]{3}\s*(?:\(?([0-9]{2})\)?)?": "&lt;NIR&gt;",
            r"(?:(?:\+|00)33|0)[ \t]*[1-9](?:[ \t.-]*\d{2}){4}": "&lt;PHONE&gt;",

            self.email_pattern: "&lt;EMAIL&gt;"
        }

    def multi_subs_by_regex(self, text: str) -&gt; Dict[Tuple[Tuple[int, int]], str]:
        """
        Find word position based on regex

        :param text: text to anonymise
        :returns: List of tuples where each tuple contains:
                - A tuple with the start and end positions of the word.
                - The replacement string.
        """
        self.position = {}
        for pattern, repl in self.PATTERNS.items():
            matches = regex.findall(pattern, text, overlapped=True)
            if matches:
                spans = [match.span() for match in regex.finditer(
                    pattern, text, overlapped=True)]

                existing_keys = list(self.position.keys())

                overlapping_keys = []
                for key in existing_keys:
                    if any(span in key for span in spans) or any(k in spans for k in key):
                        overlapping_keys.append(key)

                if overlapping_keys:
                    combined_key = tuple(
                        sorted(
                            set(span for key in overlapping_keys for span in key).union(spans))
                    )

                    for key in overlapping_keys:
                        del self.position[key]

                    self.position[combined_key] = repl
                else:
                    self.position[tuple(spans)] = repl

        return self.position

    def analyze(self, text: str):
        """
        Hide text using regular expression
        :param text: text to anonymize
        """
        return self.multi_subs_by_regex(text)</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.analyzer.RegexStrategy.analyze" class="doc doc-heading">
            <code class="highlight language-python">analyze(text)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Hide text using regular expression
:param text: text to anonymize</p>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/analyzer.py</code></summary>
              <pre class="highlight"><code class="language-python">def analyze(self, text: str):
    """
    Hide text using regular expression
    :param text: text to anonymize
    """
    return self.multi_subs_by_regex(text)</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.analyzer.RegexStrategy.multi_subs_by_regex" class="doc doc-heading">
            <code class="highlight language-python">multi_subs_by_regex(text)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Find word position based on regex</p>
<p>:param text: text to anonymise
:returns: List of tuples where each tuple contains:
        - A tuple with the start and end positions of the word.
        - The replacement string.</p>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/analyzer.py</code></summary>
              <pre class="highlight"><code class="language-python">def multi_subs_by_regex(self, text: str) -&gt; Dict[Tuple[Tuple[int, int]], str]:
    """
    Find word position based on regex

    :param text: text to anonymise
    :returns: List of tuples where each tuple contains:
            - A tuple with the start and end positions of the word.
            - The replacement string.
    """
    self.position = {}
    for pattern, repl in self.PATTERNS.items():
        matches = regex.findall(pattern, text, overlapped=True)
        if matches:
            spans = [match.span() for match in regex.finditer(
                pattern, text, overlapped=True)]

            existing_keys = list(self.position.keys())

            overlapping_keys = []
            for key in existing_keys:
                if any(span in key for span in spans) or any(k in spans for k in key):
                    overlapping_keys.append(key)

            if overlapping_keys:
                combined_key = tuple(
                    sorted(
                        set(span for key in overlapping_keys for span in key).union(spans))
                )

                for key in overlapping_keys:
                    del self.position[key]

                self.position[combined_key] = repl
            else:
                self.position[tuple(spans)] = repl

    return self.position</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="incognito_anonymizer.analyzer.Strategy" class="doc doc-heading">
            <code>Strategy</code>


</h2>


    <div class="doc doc-contents ">


        <p>Constructeur de la Class Strategy</p>






              <details class="quote">
                <summary>Source code in <code>incognito_anonymizer/analyzer.py</code></summary>
                <pre class="highlight"><code class="language-python">class Strategy:
    """Constructeur de la Class Strategy"""

    def analyze(text):
        raise NotImplementedError()</code></pre>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="mask">Mask</h2>


<div class="doc doc-object doc-module">



<a id="incognito_anonymizer.mask"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="incognito_anonymizer.mask.FakeStrategy" class="doc doc-heading">
            <code>FakeStrategy</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="incognito_anonymizer.mask.Strategy">Strategy</span></code></p>


        <p>Replace word by natural placeholder</p>






              <details class="quote">
                <summary>Source code in <code>incognito_anonymizer/mask.py</code></summary>
                <pre class="highlight"><code class="language-python">class FakeStrategy(Strategy):
    """Replace word by natural placeholder"""

    def __init__(self):
        self.natural_placehodler = {
            "&lt;PER&gt;": "Margaret Hamilton",
            "&lt;NAME&gt;": "Margaret Hamilton",
            "&lt;CODE_POSTAL&gt;": "42000",
            "&lt;DATE&gt;": "1970/01/01",
            "&lt;IPP&gt;": "IPPPH:0987654321",
            "&lt;NIR&gt;": "012345678987654",
            "&lt;EMAIL&gt;": "place.holder@anonymization.cdc",
            "&lt;PHONE&gt;": "0611223344",
            "&lt;ADRESSE&gt;": "35 Rue Margaret Hamilton",
        }

    def mask(self, text: str, coordinate: Dict[List[Tuple], str]) -&gt; str:
        """
        Replace in text, words at the given coordinates by a natural palceholder.

        :param test: text to anonymize
        :param coordinate: position and placehoder of the word to replace
        :returns: anonymzed text

        Example :
        &gt;&gt;&gt; anonymizer = FakeStrategy()
        &gt;&gt;&gt; text = "Bob"
        &gt;&gt;&gt; coordinate = {((0,3),): '&lt;NAME&gt;',}
        &gt;&gt;&gt; anonymizer.mask(text, coordinate)
        'Margaret Hamilton'
        """
        text_as_list = list(text)
        all_positions = []
        for spans, repl in coordinate.items():
            repl = self.natural_placehodler[repl]
            all_positions.extend((start, end, repl) for start, end in spans)

        all_positions.sort(key=lambda x: x[0], reverse=True)
        for start, end, repl in all_positions:
            text_as_list[start:end] = list(repl)
        return "".join(text_as_list)</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.mask.FakeStrategy.mask" class="doc doc-heading">
            <code class="highlight language-python">mask(text, coordinate)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Replace in text, words at the given coordinates by a natural palceholder.</p>
<p>:param test: text to anonymize
:param coordinate: position and placehoder of the word to replace
:returns: anonymzed text</p>
<p>Example :</p>
<blockquote>
<blockquote>
<blockquote>
<p>anonymizer = FakeStrategy()
text = "Bob"
coordinate = {((0,3),): '<NAME>',}
anonymizer.mask(text, coordinate)
'Margaret Hamilton'</p>
</blockquote>
</blockquote>
</blockquote>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/mask.py</code></summary>
              <pre class="highlight"><code class="language-python">def mask(self, text: str, coordinate: Dict[List[Tuple], str]) -&gt; str:
    """
    Replace in text, words at the given coordinates by a natural palceholder.

    :param test: text to anonymize
    :param coordinate: position and placehoder of the word to replace
    :returns: anonymzed text

    Example :
    &gt;&gt;&gt; anonymizer = FakeStrategy()
    &gt;&gt;&gt; text = "Bob"
    &gt;&gt;&gt; coordinate = {((0,3),): '&lt;NAME&gt;',}
    &gt;&gt;&gt; anonymizer.mask(text, coordinate)
    'Margaret Hamilton'
    """
    text_as_list = list(text)
    all_positions = []
    for spans, repl in coordinate.items():
        repl = self.natural_placehodler[repl]
        all_positions.extend((start, end, repl) for start, end in spans)

    all_positions.sort(key=lambda x: x[0], reverse=True)
    for start, end, repl in all_positions:
        text_as_list[start:end] = list(repl)
    return "".join(text_as_list)</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="incognito_anonymizer.mask.HashStrategy" class="doc doc-heading">
            <code>HashStrategy</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="incognito_anonymizer.mask.Strategy">Strategy</span></code></p>


        <p>Replace les mots par leur hash</p>






              <details class="quote">
                <summary>Source code in <code>incognito_anonymizer/mask.py</code></summary>
                <pre class="highlight"><code class="language-python">class HashStrategy(Strategy):
    """Replace les mots par leur hash"""

    # TODO : blake256 8 digits et paper bourrin(20ene de bytes)
    pass</code></pre>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="incognito_anonymizer.mask.HideStrategy" class="doc doc-heading">
            <code>HideStrategy</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="incognito_anonymizer.mask.Strategy">Strategy</span></code></p>


        <p>Replace by *</p>






              <details class="quote">
                <summary>Source code in <code>incognito_anonymizer/mask.py</code></summary>
                <pre class="highlight"><code class="language-python">class HideStrategy(Strategy):
    """Replace by *"""

    def mask(self, text, coordinate: Dict[List[Tuple], str]) -&gt; str:
        """
        Replace in text, words at the given coordinates by *.
        :param test: text to anonymize
        :param coordinate: position and placehoder of the word to replace
        :returns: anonymzed text

        Example :
        &gt;&gt;&gt; anonymizer = HideStrategy()
        &gt;&gt;&gt; text = "Bob"
        &gt;&gt;&gt; coordinate = {((0,3),): '&lt;NAME&gt;',}
        &gt;&gt;&gt; anonymizer.mask(text, coordinate)
        '********'

        """
        text_as_list = list(text)

        all_positions = []
        for spans, repl in coordinate.items():
            all_positions.extend((start, end, repl) for start, end in spans)

        all_positions.sort(key=lambda x: x[0], reverse=True)
        for start, end, repl in all_positions:
            word_len = end - start
            replacement = "*" * (8 if word_len &lt; 5 else word_len)
            text_as_list[start:end] = list(replacement)
        return "".join(text_as_list)</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.mask.HideStrategy.mask" class="doc doc-heading">
            <code class="highlight language-python">mask(text, coordinate)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Replace in text, words at the given coordinates by *.
:param test: text to anonymize
:param coordinate: position and placehoder of the word to replace
:returns: anonymzed text</p>
<p>Example :</p>
<blockquote>
<blockquote>
<blockquote>
<p>anonymizer = HideStrategy()
text = "Bob"
coordinate = {((0,3),): '<NAME>',}
anonymizer.mask(text, coordinate)
'<strong><em>*</em></strong>*'</p>
</blockquote>
</blockquote>
</blockquote>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/mask.py</code></summary>
              <pre class="highlight"><code class="language-python">def mask(self, text, coordinate: Dict[List[Tuple], str]) -&gt; str:
    """
    Replace in text, words at the given coordinates by *.
    :param test: text to anonymize
    :param coordinate: position and placehoder of the word to replace
    :returns: anonymzed text

    Example :
    &gt;&gt;&gt; anonymizer = HideStrategy()
    &gt;&gt;&gt; text = "Bob"
    &gt;&gt;&gt; coordinate = {((0,3),): '&lt;NAME&gt;',}
    &gt;&gt;&gt; anonymizer.mask(text, coordinate)
    '********'

    """
    text_as_list = list(text)

    all_positions = []
    for spans, repl in coordinate.items():
        all_positions.extend((start, end, repl) for start, end in spans)

    all_positions.sort(key=lambda x: x[0], reverse=True)
    for start, end, repl in all_positions:
        word_len = end - start
        replacement = "*" * (8 if word_len &lt; 5 else word_len)
        text_as_list[start:end] = list(replacement)
    return "".join(text_as_list)</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="incognito_anonymizer.mask.PlaceholderStrategy" class="doc doc-heading">
            <code>PlaceholderStrategy</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="incognito_anonymizer.mask.Strategy">Strategy</span></code></p>


        <p>Replace by placeholders</p>






              <details class="quote">
                <summary>Source code in <code>incognito_anonymizer/mask.py</code></summary>
                <pre class="highlight"><code class="language-python">class PlaceholderStrategy(Strategy):
    """Replace by placeholders"""

    def mask(self, text, coordinate: Dict[List[Tuple], str]) -&gt; str:
        """
        Replace in text, words at the given coordinates by a placeholder.
        :param test: text to anonymize
        :param coordinate: position and placehoder of the word to replace
        :returns: anonymzed text

        Example :
        &gt;&gt;&gt; anonymizer = PlaceholderStrategy()
        &gt;&gt;&gt; text = "Bob"
        &gt;&gt;&gt; coordinate = {((0,3),): '&lt;NAME&gt;',}
        &gt;&gt;&gt; anonymizer.mask(text, coordinate)
        '&lt;NAME&gt;'

        """
        text_as_list = list(text)

        all_positions = []
        for spans, repl in coordinate.items():
            all_positions.extend((start, end, repl) for start, end in spans)

        all_positions.sort(key=lambda x: x[0], reverse=True)
        for start, end, repl in all_positions:

            text_as_list[start:end] = list(repl)
        return "".join(text_as_list)</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="incognito_anonymizer.mask.PlaceholderStrategy.mask" class="doc doc-heading">
            <code class="highlight language-python">mask(text, coordinate)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Replace in text, words at the given coordinates by a placeholder.
:param test: text to anonymize
:param coordinate: position and placehoder of the word to replace
:returns: anonymzed text</p>
<p>Example :</p>
<blockquote>
<blockquote>
<blockquote>
<p>anonymizer = PlaceholderStrategy()
text = "Bob"
coordinate = {((0,3),): '<NAME>',}
anonymizer.mask(text, coordinate)
'<NAME>'</p>
</blockquote>
</blockquote>
</blockquote>

            <details class="quote">
              <summary>Source code in <code>incognito_anonymizer/mask.py</code></summary>
              <pre class="highlight"><code class="language-python">def mask(self, text, coordinate: Dict[List[Tuple], str]) -&gt; str:
    """
    Replace in text, words at the given coordinates by a placeholder.
    :param test: text to anonymize
    :param coordinate: position and placehoder of the word to replace
    :returns: anonymzed text

    Example :
    &gt;&gt;&gt; anonymizer = PlaceholderStrategy()
    &gt;&gt;&gt; text = "Bob"
    &gt;&gt;&gt; coordinate = {((0,3),): '&lt;NAME&gt;',}
    &gt;&gt;&gt; anonymizer.mask(text, coordinate)
    '&lt;NAME&gt;'

    """
    text_as_list = list(text)

    all_positions = []
    for spans, repl in coordinate.items():
        all_positions.extend((start, end, repl) for start, end in spans)

    all_positions.sort(key=lambda x: x[0], reverse=True)
    for start, end, repl in all_positions:

        text_as_list[start:end] = list(repl)
    return "".join(text_as_list)</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
